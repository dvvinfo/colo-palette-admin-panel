# üí≥ –°–∏—Å—Ç–µ–º–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞–º–∏

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏, –≤–∫–ª—é—á–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç, –æ–±–º–µ–Ω–Ω—ã—Ö –∫—É—Ä—Å–æ–≤ –∏ –º–Ω–æ–≥–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã](#api-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö)
- [–í–∞–ª—é—Ç—ã –∏ –∫—É—Ä—Å—ã](#–≤–∞–ª—é—Ç—ã-–∏-–∫—É—Ä—Å—ã)
- [–°—Ç–∞—Ç—É—Å—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π](#—Å—Ç–∞—Ç—É—Å—ã-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
- [–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è](#—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è-–∏-–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- [Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#frontend-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)

## üöÄ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### GET `/api/transaction/`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `page` (number) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1)
- `query` (string, optional) - –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, email –∏–ª–∏ ID
- `status` (string, optional) - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É
- `type` (string, optional) - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```
GET /api/transaction/?page=1&status=success&query=admin
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "data": [
    {
      "id": 1,
      "user_id": 42,
      "currency": "btc",
      "amount_raw": 0.001,
      "rate": 5500000,
      "amount_rub": 5500,
      "status": "success",
      "created_at": "2024-01-15T10:30:00Z",
      "user": {
        "id": 42,
        "username": "admin",
        "email": "admin@example.com",
        "role_id": 1,
        "provider": "",
        "provider_id": "",
        "balance": 1000000,
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-15T10:30:00Z",
        "role": {
          "id": 1,
          "name": "admin",
          "permissions": null
        }
      }
    }
  ],
  "page": 1,
  "pages": 10,
  "total": 200
}
```

### PUT `/api/transaction/{id}/status`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "status": "success"
}
```

### GET `/api/user/{userId}/transaction`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### Transaction
```typescript
interface Transaction {
  id: number                    // ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  user_id: number              // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  currency: 'btc' | 'eth' | 'usdt' | 'rub'  // –í–∞–ª—é—Ç–∞
  amount_raw: number           // –°—É–º–º–∞ –≤ –∏—Å—Ö–æ–¥–Ω–æ–π –≤–∞–ª—é—Ç–µ
  rate: number                 // –ö—É—Ä—Å –∫ —Ä—É–±–ª—é (1 –¥–ª—è RUB)
  amount_rub: number           // –°—É–º–º–∞ –≤ —Ä—É–±–ª—è—Ö
  status: TransactionStatus    // –°—Ç–∞—Ç—É—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  created_at: string          // –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è (ISO string)
  user: User                  // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
}
```

### User
```typescript
interface User {
  id: number
  username: string
  email: string | null
  role_id: number
  provider: string
  provider_id: string
  balance: number
  created_at: string
  updated_at: string
  role: Role
}
```

### Role
```typescript
interface Role {
  id: number
  name: string
  permissions: null
}
```

## üí∞ –í–∞–ª—é—Ç—ã –∏ –∫—É—Ä—Å—ã

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–∞–ª—é—Ç—ã

| –í–∞–ª—é—Ç–∞ | –ö–æ–¥    | –û–ø–∏—Å–∞–Ω–∏–µ        | –ö—É—Ä—Å –∫ —Ä—É–±–ª—é |
|--------|--------|-----------------|--------------|
| Bitcoin| `btc`  | –ë–∏—Ç–∫–æ–∏–Ω         | ~5,500,000   |
| Ethereum| `eth` | –≠—Ñ–∏—Ä–∏—É–º         | ~350,000     |
| Tether | `usdt` | USDT            | ~100         |
| –†—É–±–ª—å  | `rub`  | –†–æ—Å—Å–∏–π—Å–∫–∏–π —Ä—É–±–ª—å| 1            |

### –†–∞—Å—á–µ—Ç —Å—É–º–º

- **amount_raw** - —Å—É–º–º–∞ –≤ –∏—Å—Ö–æ–¥–Ω–æ–π –≤–∞–ª—é—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.001 BTC)
- **rate** - –∫—É—Ä—Å –≤–∞–ª—é—Ç—ã –∫ —Ä—É–±–ª—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, 5,500,000 –¥–ª—è BTC)
- **amount_rub** - —Å—É–º–º–∞ –≤ —Ä—É–±–ª—è—Ö (amount_raw √ó rate)

**–ü—Ä–∏–º–µ—Ä:**
```javascript
// –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–∞ 0.001 BTC
const transaction = {
  currency: 'btc',
  amount_raw: 0.001,           // 0.001 BTC
  rate: 5500000,               // 1 BTC = 5,500,000 RUB
  amount_rub: 5500             // 0.001 √ó 5,500,000 = 5,500 RUB
}
```

## üìä –°—Ç–∞—Ç—É—Å—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

| –°—Ç–∞—Ç—É—Å      | –û–ø–∏—Å–∞–Ω–∏–µ                    | –¶–≤–µ—Ç    |
|-------------|----------------------------|---------|
| `pending`   | –û–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏          | üü° Yellow|
| `progress`  | –í –ø—Ä–æ—Ü–µ—Å—Å–µ                 | üîµ Blue  |
| `success`   | –£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞          | üü¢ Green |
| `completed` | –ó–∞–≤–µ—Ä—à–µ–Ω–∞                  | üü¢ Green |
| `failed`    | –û—à–∏–±–∫–∞                     | üî¥ Red   |
| `cancelled` | –û—Ç–º–µ–Ω–µ–Ω–∞                   | ‚ö´ Gray  |
| `rejected`  | –û—Ç–∫–ª–æ–Ω–µ–Ω–∞                  | üî¥ Red   |

## üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

```typescript
interface TransactionFilters {
  page?: number          // –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  query?: string         // –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É
  status?: string        // –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É
  type?: string          // –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É
}
```

### –û—Ç–≤–µ—Ç —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

```typescript
interface TransactionsResponse {
  data: Transaction[]    // –ú–∞—Å—Å–∏–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  page: number          // –¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  pages: number         // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
  total?: number        // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
}
```

## üíª –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

```typescript
import { transactionsApi } from '@/services/api'

// –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
const response = await transactionsApi.getAll({ page: 1 })

// –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const searched = await transactionsApi.getAll({ 
  query: 'admin',
  page: 1 
})

// –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É
const successful = await transactionsApi.getAll({ 
  status: 'success',
  page: 1 
})
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

```typescript
// –û–¥–æ–±—Ä–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
await transactionsApi.updateStatus(123, 'success')

// –û—Ç–∫–ª–æ–Ω–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
await transactionsApi.updateStatus(123, 'rejected')
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```typescript
const userTransactions = await transactionsApi.getUserTransactions(42)
console.log(userTransactions.data)
```

## üé® Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### TransactionsTable.vue
–û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏, –≤–∫–ª—é—á–∞–µ—Ç:
- ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—é
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —Å—Ç–∞—Ç—É—Å—É
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∞–ª—é—Ç —Å –∏–∫–æ–Ω–∫–∞–º–∏
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É–º–º
- ‚úÖ –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π

### TransactionModal.vue
–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–µ—Ç–∞–ª—è–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –û–±–º–µ–Ω–Ω—ã–π –∫—É—Ä—Å –∏ —Å—É–º–º—ã
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ store

```typescript
// –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
const transactionsStore = useTransactionsStore()
await transactionsStore.fetchTransactions({ page: 1, status: 'pending' })

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
console.log(transactionsStore.statistics.deposits)
console.log(transactionsStore.statistics.pending)
console.log(transactionsStore.statistics.totalTurnover)
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Proxy –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (vite.config.ts)

```typescript
export default defineConfig({
  server: {
    proxy: {
      '/api': {
        target: 'http://77.246.247.145',
        changeOrigin: true,
        secure: false,
        rewrite: (path) => {
          const newPath = path.replace(/^\/api/, '')
          console.log('üîÑ Rewriting:', path, '‚Üí', newPath);
          return newPath
        }
      }
    }
  }
})
```

### API –±–∞–∑–æ–≤—ã–π URL

```typescript
const getBaseURL = () => {
  if (import.meta.env.DEV) {
    return '/api'  // Vite proxy –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
  }
  
  if (window.location.hostname.includes('vercel.app')) {
    return '/api/proxy'  // Vercel production
  }
  
  return import.meta.env.VITE_API_BASE_URL || 'http://77.246.247.145'
}
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ **–º–æ–∫-–¥–∞–Ω–Ω—ã–µ**:

```typescript
try {
  const response = await transactionsApi.getAll(filters)
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
} catch (error) {
  console.warn('API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–æ–∫-–¥–∞–Ω–Ω—ã–µ')
  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–∫-–¥–∞–Ω–Ω—ã–µ
  const mockData = generateMockTransactions()
  // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∫ –º–æ–∫-–¥–∞–Ω–Ω—ã–º
}
```

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:

```typescript
const statistics = computed(() => ({
  deposits: { count: 0, amount: 0 },     // –£—Å–ø–µ—à–Ω—ã–µ –¥–µ–ø–æ–∑–∏—Ç—ã
  withdrawals: { count: 0, amount: 0 },  // –í—ã–≤–æ–¥—ã (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
  pending: { count: 0, amount: 0 },      // –û–∂–∏–¥–∞—é—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  totalTurnover: 0                       // –û–±—â–∏–π –æ–±–æ—Ä–æ—Ç
}))
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ `withdrawals` –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è `type` –≤ Transaction –∏–ª–∏ –¥—Ä—É–≥–æ–π –ª–æ–≥–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `type` –¥–ª—è —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è –¥–µ–ø–æ–∑–∏—Ç–æ–≤ –∏ –≤—ã–≤–æ–¥–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—ã–≤–æ–¥–∞–º
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–∞—Ö
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É 